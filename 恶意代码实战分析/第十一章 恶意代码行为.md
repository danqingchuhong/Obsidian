## 行为
#### 下载器
- URLDownloadFlieA和WinExec，下载并运行恶意代码
#### 后门
- 能让攻击者访问一个受害的机器
- 例如利用80端口使用http协议，混淆流量
- 有一套功能，操作注册表，列举窗口，搜索文件等。
#### 反向shell
- 被感染的主机上发起一个链接，提供攻击者shell访问感染主机权限
- 传递给CreteProcess的STARTUPINFO结构，创建一个套接字，并与远程服务器相连。绑定这个套接字与cmd.exe标准流，调用CreteProcess函数用隐藏方式创建cmd.exe。
- windows反向shell多线程版本涉及一个套接字、两个管道及两个线程的创建（CreteProcess，CreatePipe）。
#### 远程控制工具
- 通常通过80、443等常用的端口通信
## 窃取通信凭证
- 用户登录时窃取
- 转储windows存放信息，并离线破解
- 敲击记录
#### GINA拦截
- GINA合法第三方登录，恶意代码利用GINA对第三方支持加载窃密器
- GINA在msgina.dll中实现。第三方dll由Winlogon可执行文件加载。且利用注册表存储第三方dll。
- 如果一个dll出现很多前缀为Wlx的导出函数，就很有可能是一个GINA拦截器。
#### 口令哈希转储
- 利用Pass-the-Hash攻击，无需破解口令获取明文的情况下，使用LM或NTLM哈希通过远程主机的身份验证。
- 多次调用GetProcAdress
#### 击键记录
- 通过hook或者轮询来实现常使用：SetWindowsHookEx、GetAsyncKeyState、GetForegroundWindow.
- 通过字符串识别，比如shift、numlock等。
## 存活机制
- 修改系统注册表
#### windows注册表
- Applnit_DLL：加载User32.dll时被加载。插入DLL路径到注册表Applnit_DLL，让DLL程序获得加载机会。
- Winlogon Notify：当Winlogon.exe产生一个事件时，Windows会检测Notify注册表键来查找处理这个DLL程序
- SvcHost
#### 特洛伊化系统二进制文件
- 修改一个系统二进制文件，该文件启动时，恶意程序也会启动。
#### DLL加载顺序劫持
- windows xp加载dll的默认搜索顺序：
	- 1、加载应用程序的目录
	- 2、当前目录
	- 3、系统目录
	- 4、16位子系统的系统目录
	- 5、windows目录
	- 6、path环境变量的目录
- 将一个假的系统dll文件放在搜索顺序之前。
## 提权
- 使用SeDebugPrivilege
## 用户态Rootkit
- 使恶意代码文件、进程、网络连接等其他资源对其隐藏。
#### IAT Hook
- 隐藏在本地系统文件、进程以及网络连接修改iat和eat。